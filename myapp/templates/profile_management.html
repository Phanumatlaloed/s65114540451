{% load static %}
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'styles/profile_management.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="profile-card">
            <div class="profile-header">
                <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö -->
                <div class="back-btn-container">
                    <a href="{% url 'profile' request.user.id %}" class="btn btn-back">
                        <i class="fas fa-arrow-left"></i> ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö
                    </a>
                </div>
                <h2 class="text-center">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</h2>
                <div class="welcome-message">
                    <p class="text-center">üëã ‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ, <span class="text-highlight">{{ user.username }}</span></p>
                    <p class="text-center subtitle">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏∏‡∏°‡∏ä‡∏ô‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å‡∏Ñ‡∏∏‡∏ì‡∏î‡∏µ‡∏Ç‡∏∂‡πâ‡∏ô!</p>
                </div>
            </div>
            
            <div class="divider">
                <span><i class="fas fa-user-edit"></i></span>
            </div>
            
            <div class="row">
                <!-- Profile Information Form -->
                <div class="col-md-6">
                    <div class="form-section">
                        <h3><i class="fas fa-address-card"></i> ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß</h3>
                        <form method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            
                            <div class="profile-picture-container">
                                <div class="profile-picture-wrapper">
                                    {% if user.member_profile.profile_picture %}
                                        <img src="{{ user.member_profile.profile_picture.url }}" alt="Profile Picture" class="profile-picture">
                                    {% else %}
                                        <img src="{% static 'images/default-profile.png' %}" alt="Profile Picture" class="profile-picture">
                                    {% endif %}
                                    <div class="picture-overlay">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                </div>
                                <!-- <label for="profile-upload" class="btn btn-outline-primary btn-sm mt-2">
                                    <i class="fas fa-upload"></i> ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
                                </label> -->
                                <input id="profile-upload" type="file" name="profile_picture" class="form-control d-none">
                            </div>
                            
                            <div class="form-fields">
                                {{ form.as_p }}  <!-- ‡πÉ‡∏ä‡πâ Django Forms -->
                            </div>
                            
                            <!-- ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å -->
                            <div class="text-center">
                                <button type="submit" name="update_personal_info" class="btn btn-primary">
                                    <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß
                                </button>                                
                            </div>
                        </form>
                    </div>
                </div>
                
                <!-- Change Password Form -->
                <div class="col-md-6">
                    <div class="form-section">
                        <h3><i class="fas fa-key"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</h3>
                        <form method="post">
                            {% csrf_token %}
                            <div class="form-fields password-fields">
                                {{ password_form.as_p }}
                            </div>
                            <div class="text-center">
                                <button type="submit" name="change_password" class="btn btn-warning">
                                    <i class="fas fa-lock"></i> ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                                </button>
                            </div>
                        </form>
                        
                        <div class="password-tips">
                            <h4><i class="fas fa-info-circle"></i> ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ</h4>
                            <ul>
                                <li>‡πÉ‡∏ä‡πâ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 8 ‡∏ï‡∏±‡∏ß</li>
                                <li>‡∏ú‡∏™‡∏°‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏´‡∏ç‡πà‡πÅ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏•‡πá‡∏Å</li>
                                <li>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏Å‡∏Ç‡∏£‡∏∞‡∏û‡∏¥‡πÄ‡∏®‡∏©</li>
                                <li>‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡∏Ñ‡∏≤‡∏î‡πÄ‡∏î‡∏≤‡πÑ‡∏î‡πâ‡∏á‡πà‡∏≤‡∏¢</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
        document.getElementById('profile-upload').addEventListener('change', function() {
            if (this.files && this.files[0]) {
                var reader = new FileReader();
                
                reader.onload = function(e) {
                    document.querySelector('.profile-picture').src = e.target.result;
                }
                
                reader.readAsDataURL(this.files[0]);
            }
        });
        
        // ‡πÅ‡∏™‡∏î‡∏á overlay ‡πÄ‡∏°‡∏∑‡πà‡∏≠ hover ‡∏£‡∏π‡∏õ‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
        document.querySelector('.profile-picture-wrapper').addEventListener('mouseenter', function() {
            document.querySelector('.picture-overlay').style.opacity = '1';
        });
        
        document.querySelector('.profile-picture-wrapper').addEventListener('mouseleave', function() {
            document.querySelector('.picture-overlay').style.opacity = '0';
        });
        
        // ‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡∏£‡∏π‡∏õ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå
        document.querySelector('.profile-picture-wrapper').addEventListener('click', function() {
            document.getElementById('profile-upload').click();
        });
    </script>
</body>
</html>